// Import.
const assert = require('assert');
const saltedMd5 = require('../index');

// Constants.
const TEST_DATA_LIST = [
  { data: 'Some data.', salt: undefined, correctResult: '069972bd107688743d20a177a701490f' },
  { data: 'Some data.', salt: '', correctResult: '069972bd107688743d20a177a701490f' },
  { data: 'Some data.', salt: 'SUPER-S@LT!', correctResult: '1b25469a2e4b157f02dd1fea3b5f1e9a' },
  { data: undefined, salt: 'SUPER-S@LT!', correctResult: '8dcf756d53138e51b5b7355b04b8f2ad' },
  { data: '', salt: 'SUPER-S@LT!', correctResult: '8dcf756d53138e51b5b7355b04b8f2ad' }
];

/**
 * Check sync.
 */
describe('Check sync.', () => {
  it('Should be equals with precalculated results.', () => {
    for (const testData of TEST_DATA_LIST) {
      const { data, salt, correctResult } = testData;
      const saltedHash = saltedMd5(data, salt);
      assert.equal(saltedHash, correctResult);
    }
  });
});

/**
 * Check async.
 */
describe('Check async.', () => {
  it('Should be equals with precalculated results.', async () => {
    for (const testData of TEST_DATA_LIST) {
      const { data, salt, correctResult } = testData;
      const saltedHash = await saltedMd5(data, salt, true);
      assert.equal(saltedHash, correctResult);
    }
  });
});
